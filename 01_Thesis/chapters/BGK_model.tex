% !TEX root = master.tex


\chapter{The BGK Model}
\label{Ch:BGK}
%\pagenumbering{arabic}




This section covers the kinetic gas model, the BGK model, on which a model order reduction will be performed in the following. In addition the SOD-shocktube, on which the BGK model will be tested is discussed.\\
The BGK model is valid for a broad range of rarefaction levels. Ranging from continuum flows, where the Navier-Stokes equations can be utilized to highly rarefied regimes. Rarefaction levels are labeled with the so called Knudsen number \(\Kn\) first introduced by danish physicist Martin Knudsen \cite{Bernard}. the Knudsen number is given by
\begin{equation}
	\Kn = \frac{\lambda}{l}, 
\end{equation}
where \(\lambda\) is the mean free path of a particle and \(l\), some domain specific length as the diameter of a tube for example. \Cref{Fig:ExpKN} shows a possible partitioning of \(\Kn\) into specific regimes, which is quiet comfortable. Though no clear cut can be applied to different values of \(\Kn\). The boundaries are particularly blurry \cite{schaaf}.
\begin{figure}[H]
	\input{Figures/BGK/Kn.tex}
	\caption{Partitioning of \(\Kn\), the Knudsen number, into levels of rarefaction. The Euler equations can be used up to approximately \(\Kn < 0.01\) and describe a \glqq continuum flow\grqq{}. A \grqq slip flow\grqq{} can be defined in the interval \(0.01 < \Kn < 0.1\), termed as slightly rarefied in \cite{schaaf}. Here the Navier-stokes-Fourrier equations yield accurate results. From \(\Kn > 0.1\) onwards (transition regime, kinetic regime and free flight) the rarefaction increases steadily and only kinetic gas models deliver reasonable computations. The BGK model can be used for all rarefaction levels.}
	\label{Fig:ExpKN}
\end{figure}
\section{Space and Velocity Discretization, Moments and Conservation}
The BGK model was introduced by, and named after, physicists Prabhu L. Bhatnagar, Eugene P. Gross and Max Krook in 1954 \cite{BGK}. It is an approximation of the standard Boltzmann transport equation. More precisely the right hand side of the Boltzmann equation is approximated by the BGK operator 
\begin{equation}
\partial_t f + v \partial_x f = \frac{1}{\tau} (M_f - f) \text{,}
\label{Eq:BGK}
\end{equation}
which can be found in \cite{puppo2019kinetic}.It features the relaxation time \(\tau(x,t)\), the Maxwellian distribution \(M_f\) and \(f(x,v,t)\) the probability of a gas particle having a microscopic velocity \(v\) in phase space \((x,v,t)\). The right hand side is a source term describing the distance between the current probability density function \(f\) and it's equilibrium solution \(M_f\). Evidently when \(f = M_f\) the right hand side becomes zero. More precisely equilibirum is reached. A time scale for which \(f\) transitions into equilibrium is given by \(\tau\) which can be defined with
\begin{equation}
	\tau^{-1} = \frac{\rho(x,t)T^{1-\nu}(x,t)}{\Kn}\mathrm{,}
\end{equation}
taken from \cite{Bernard}. Through \(\tau\) the viscosity exponent \(\nu\), density \(\rho\), temperature \(T\) and Knudsen number \(\Kn\) additionally establish a scaling factor for the right hand side of the BGK model. The Maxwellian distribution \(M_f\) is defined by \(\rho(x,t)\), \(T(x,t)\) and \(u(x,t)\) the macroscopic velocity
\begin{equation}
M_f = \frac{\rho(x,t)}{(2\pi R T(x,t))^{\frac{3}{2}}}\exp(-\frac{(v - u(x,t))^2}{2 R T(x,t)}) \text{.}
\end{equation} 
The left hand side of the BGK model is the Boltzmann transport equation for \(f(x,v,t)\) with microscopic transport velocity \(v\).
In one dimension, the BGK model needs to be evaluated for the three independent variables \(x\), \(v\) and \(t\) as seen above. Furthermore in three dimensions one needs to include the evaluation at \((x,y,z)\) in space and \((v_x,v_y,v_z)\) in velocity space. Note that in this thesis the BGK model is discussed in one dimension only.\\ 
Now what makes the BGK model especially attractive for model order reduction?
The fruitfullness of performing a model order reduction on the BGK model becomes clearer when looking at it's space and velocity discretization
\begin{equation}
	\partial_t f_{j,k} = -(v_k)_1D_x f|_{j,k}(t) + \frac{1}{\tau}({M_f}_{j,k}(t) - f_{j,k}(t)) \text{,}
	\label{Eq:Discrete BGK}
\end{equation}
found in \cite{puppo2019kinetic}. Here a uniform grid is considered with \(x_j = j\Delta x\), \(j \in \mathbb{Z}\), \(v_k = k\Delta v\), \(k \in \mathbb{Z}\) and \(t^n = n \Delta t\), \(n \in \mathbb{N}\) on which \(f_{j,k} = f(x_j,v_k,t)\) and \({M_f}_{j,k} = M_f(x_j,v_k,t)\) are evaluated at point \((x_j,v_k)\) in a time instance \(t\). For brevity \(D_x f|_{j,k}\) is the discrete space derivative at \((x_j,v_k)\). Now the partial differential equation (PDE) in \cref{Eq:BGK} is broken down into a system of ordinary differential equations (ODE's) in time, for which every ODE is a linear advection equation with constant scalar speed \(v_k\) and a source term.\\
To continue let's consider \(K\) to be the number of gridpoints in velocity and \(J\) to be the number of grid points in space. Then a total of \(KJ\) first order differential equations need to be evaluated in 1D. Obviously in three dimensions the system of ODE's inflates up to \(K^3J^3\) first order differential equations. This in turn drives the evaluation of the BGK model at the edge of intractability for dense meshes in 3D and all together motivate for a reduced order model.\\
A closer look on the discretization in velocity space yields the necessity to compute the moments of \(f\) and provides a system of conservative equations.\\  
\begin{wrapfigure}{r}{0.5\textwidth}
	\vspace{-10pt}
	\scalebox{.9}{\input{Figures/BGK/Boltzmann.tex}}
	\caption{Illustration of the linkage between the macroscopic quantities of the gas flow and the distribution function \(f\).}
	\vspace{-70pt}
	\label{Fig:Demo Macro}
\end{wrapfigure}
Moments or expected values of \(f\) are the density \(\rho\), the momentum \(\rho u\) and the energy \(E\) in velocity spacewhich can be obtained with
	\begin{align} 
	\rho(x,t) &= \int\! f \,\mathrm{d}v  \mathrm{,}\label{Eq:Moments1}\\
	\rho(x,t) u(x,t) &= \int\! v f \,\mathrm{d}v \mathrm{,}\label{Eq:Moments2}\\
	E(x,t) &= \int\! \frac{1}{2}v^2 f  \,\mathrm{d}v \mathrm{,}\label{Eq:Moments3}
	\end{align}
as explained in  \cite{puppo2019kinetic}. With multiplying \(\Phi(v) = [1,v,\frac{1}{2} v^2]\), called the collision invariants, and integrating in velocity space, one obtains the moments of \(f\), which are needed to compute the maxwellian in \cref{Eq:Discrete BGK}.\\

Again the system in \cref{Eq:BGK} is in equilibrium when \(f = M_f\). Now by multiplying the equilibrium solution (left hand side of \cref{Eq:BGK} substituting \(f=M_f\)) by \(\Phi(v)\) and integrating in velocity space, one finds the Euler system of classical gas dynamics using the equation of state of the gas as in \cite{puppo2019kinetic}. These are
\begin{align}
	\partial_t&\rho + \partial_x(\rho u) = 0 \mathrm{,}\label{Eq:Conservation1} \\
	\partial_t&(\rho u) + \partial_x(\rho u^2 + p) = 0\mathrm{,}\label{Eq:Conservation2}\\
	\partial_t&E + \partial_x(u(E+p)) = 0\label{Eq:Conservation3}\mathrm{,}
\end{align}
and provide conservation laws for the BGK model. Note that the evaluation of the maxwellian\(M_f\) is not straight forward and requires three additional non linear equations for every \(K\)-th grid point in velocity space. This is due to the fact, that for \(M_f\) the moments in \cref{Eq:Moments1}, \cref{Eq:Moments2} and \cref{Eq:Moments3} are needed. The quadrature rule used to compute the moments requires to be exact because even small errors magnify when \(\tau \rightarrow 0\) and in turn one fails to obtain the Euler equations. Therefore \(M_f\) must satisfy  
\begin{equation}
	<\Phi(v)f> - <\Phi(v)M_f> = 0\mathrm{,}
\end{equation}
which is accomplished by the computation of a discrete Maxwellian \(\mathcal{M}_f\) by solving
\begin{equation}
	\sum_k w_k \Phi(v_k) [f(x,v_k,t) - \exp(\alpha(x,t)\Phi(v_k))] = 0\mathrm{.}
\end{equation}
Here \(w_k\) are weights and \(\alpha(x,t)\) is a vector of three elements from which a unique solution for can be determined for \(\mathcal{M}_f\). Further insights on \(\mathcal{M}_f\) and time discretization will be omitted.\\

Displayed in \cref{Fig:Demo Macro} is a demonstrative example of how the distribution function \(f(v)\) gives the values for the macroscopic quantities. The distribution is centered around the macroscopic velocity \(u\), the mean velocity of the distribution \(f\) is the temperature \(T\), integrating \(f(v)\) over velocity space one obtains the density \(\rho\).\\ 

The BGK model inherits global conservation of mass, momentum and energy from the Boltzmann equation as seen in \cref{Eq:Conservation1}, \cref{Eq:Conservation2} and \cref{Eq:Conservation3} found in \cite{puppo2019kinetic}.
\section{Sod's shock tube as a test case for the BGK model} \label{Sec:FeaturesSOD}
Using a shock tube as a test case for numerical schemes solving nonlinear hyperbolic conservation laws in gas dynamics was first introduced by Gary A. Sod in 1978 \cite{Sod}. Since then it serves as a commonly used benchmark problem. Nonlinear conservation laws in a simple shock tube can be solved analytically and thereafter be compared to the numerical approximation. The analytical solution is obtained using the method of characteristics and the Rankine Hugoniot jump conditions to connect the states before and after the shock. Details about both methods can be found in \cite{CFD1}. The problem setup for a shock tube is shown in \cref{Fig:SodProbSetup} and \cref{Fig:SodTime}, which is split into two areas. Here the initial conditions are \(\rho_0 = 1\) and \(\rho_5=0.125\) for the density, \(p_0=1\) and \(p_5=0.1\) for the pressure and \(u_0=u_5=0\) for the macroscopic velocity.
\begin{figure}[H]
	\centering
	\input{Figures/BGK/Sod.tex}
	\caption{Problem setup for the Sod shock tube in 1D. A diaphragm is positioned at \(x_d\), seperating the whole domain in two areas. Shown are the starting conditions for density \(\rho\), pressure \(p\) and macroscopic velocity \(u\).}
	\label{Fig:SodProbSetup}
\end{figure}

\begin{figure}[H]
	\begin{subfigure}{.45\textwidth}
		\centering
		\input{Figures/BGK/Sod_time0.tex}
		\caption{Sod's shock tube at \(t=0\). The whole domain is split into two regions with corresponding initial conditions for pressure \(p\), density \(\rho\) and macroscopic velocity \(u\). Position of the diaphragm is labeled as \(x_d\).\\ \\ \\}
		\label{Fig:SodTime}
	\end{subfigure}\hfill
	\begin{subfigure}{.45\textwidth}
		\centering
		\input{Figures/BGK/Sod_time.tex}
		\caption{Sod's shock tube at \(t>0\). Shown are pressure \(p\), denisty \(\rho\)  and macroscoppic velocity \(u\). Five regions can be identified marked out with \(x_1\) and \(x_2\) as head and tail of the rarefaction wave, \(x_3\) as the contact discontinuity and \(x_4\) as the position of the shock wave. The position of the initial diaphragm is labeled \(x_d\) and \(x_3\) also locating a particle having traveled from there during \(\Delta t\).}
		\label{Fig:SodTime0}
	\end{subfigure}\\ \vfill
	\begin{subfigure}{\textwidth}
		\centering
		\input{Figures/BGK/ExamplesSod.tex}
		\caption{Two solutions of the BGK model \(f(v,x,t_i)\) in Sod's shock tube with \(\Kn=0.00001\) (top row) and \(\Kn=0.01\) (bottom row) for a fixed time \(t_i\). Solutions are presented for \(t_0=0s\), \(t_1=0.06s\) and \(t_2=0.12s\).}
		\label{Fig:ExamplesSod}
	\end{subfigure}\\
	\begin{subfigure}{\textwidth}
		\input{Figures/BGK/MacroFOMhyvsrare.tex}
		\caption{Macroscopic quantities \(\rho(x,t_i)\), \(\rho u(x,t_i)\) and \(E(x,t_i)\) in the SOD schock tube at \(t_i=0.12s\). Displayed are the quantities for \(\Kn=0.00001\)  in - - lines and for \(\Kn=0.01\) in - lines, where the former is abbreviated with \(\hy\) and the latter with \(\rare\).}
	\end{subfigure}\caption{BGK model in Sod's shock tube: Initial conditions and their evolution after \(\Delta t\) are shown in (a) and (b). Two solutions of differing rarefaction levels are presented in (c). Macroscopic quantities at \(t=0.12s\) are shown in (d).}
\end{figure}

%\begin{figure}[!htbp]
%	\input{Figures/BGK/MacroFOMhyvsrare.tex}
%	\caption{Macroscopic quantities \(rho\), \(\rho u\) and \(E\) in the SOD schock tube at the last time stamp. The quantites are displayed for the hydrodynamic regime in - - lines and for the rarefied regime in - lines.}
%\end{figure}
