% !TEX root = master.tex


\chapter{The BGK Model}
\label{Ch:BGK}
%\pagenumbering{arabic}




This section covers the kinetic gas model, the BGK model, on which a model order reduction will be performed in the following. In addition the SOD-shocktube, on which the BGK model will be tested is discussed.\\
\section{Discretization, conservative properties and equilibirum}
The BGK model was introduced by, and named after, physicists Prabhu L. Bhatnagar, Eugene P. Gross and Max Krook in 1954 \cite{BGK}. It is an approximation of the standard Boltzmann transport equation. More precisely the r.h.s of the Boltzmann equation is approximated by the BGK operator \cite{puppo2019kinetic}
\begin{equation}
\partial_t f + v \partial_x f = \frac{1}{\tau} (M_f - f) \text{.}
\label{Eq:BGK}
\end{equation}
It consists of the relaxation time \(\tau(x,t)\), the Maxwellian distribution \(M_f\) and \(f(x,v,t)\) the probability of a gas particle having a microscopic velocity \(v\) in phase space \((x,v,t)\). The left side of the BGK model is a transport equation for \(f(x,v,t)\) with transport velocity \(v\). In the maxwellian distribution \(n(x,t)\) is the number of particles in space and time, \(R\) is the specific gas constant, \(T^0(x,t)\) is the temperature and \(u(x,t)\) is the macroscopic velocity
\begin{equation}
M_f = \frac{n(x,t)}{\sqrt{2\pi R T^0(x,t)}}\exp(-\frac{(v - u(x,t))^2}{2 R T^0(x,t)}) \text{.}
\end{equation}
Note that in this thesis the BGK model is discussed in one dimension. Hence the BGK model needs to be evaluated for three independent variables \(x\), \(v\) and \(t\) as seen above.\\ 
Now what makes the BGK model especially attractive for model order reduction?
The fruitfullness of performing a model order reduction on the BGK model becomes clearer when looking at it's space and velocity discretization
\begin{equation}
	\partial_t f_{j,k} = -(v_k)_1D_x f|_{j,k}(t) + \frac{1}{\tau}({M_f}_{j,k}(t) - f_{j,k}(t)) \text{.}
	\label{Eq:Discrete BGK}
\end{equation}
Here a uniform grid is considered with \(x_j = j\Delta x\), \(j \in \mathbb{Z}\), \(v_k = k\Delta v\), \(k \in \mathbb{Z}\) and \(t^n = n \Delta t\), \(n \in \mathbb{N}\) on which \(f_{j,k} = f(x_j,v_K,t)\) and \({M_f}_{j,k} = M_f(x_j,v_k,t)\) are evaluated at point \((x_j,v_k)\) in a time instance \(t\). For brevity \(D_x f|_{j,k}\) is the discrete space derivative at \((x_j,v_k)\) \cite{puppo2019kinetic}. Now the partial differential equation (PDE) in \cref{Eq:BGK} is broken down into a system of ordinary differential equations (ODE's) in time, for which every ODE is a linear advection equation with constant scalar speed \(v_k\) and a source term.\\ 
To continue let's consider \(K\) to be the number of gridpoints in velocity and \(J\) to be the number of grid points in space. Then a total of \(KJ\) first order differential equations need to be evaluated in 1D. Obviously in three dimensions the system of ODE's inflates up to \(K^3N^3\) first order differential equations \cref{Eq:Discrete BGK}. This in turn drives the evaluation of the BGK model at the edge of intractability for dense meshes in 3D and all together stimulate the want for a reduced order model.\\
\begin{wrapfigure}{r}{0.5\textwidth}
	\vspace{-10pt}
	\begin{center}
		\scalebox{.9}{\input{Figures/BGK/Boltzmann.tex}}
	\end{center}
	\caption{Illustration of the linkage between the macroscopic quantities of the gas flow and f the distribution function \(f\).}
	\vspace{-40pt}
	\label{Fig:Demo Macro}
\end{wrapfigure}
In order to evaluate \(M_f\) and therefore \cref{Eq:Discrete BGK} the macroscopic velocity \(u(x,t)\) is required. Other macroscopic quantities of the gas flow, namely  the density \(\rho\), the momentum \(\rho u\) and the energy \(E\) are the expected values or moments of \(f\) in velocity space and can be calculated with 
\begin{align}
	\rho(x,t) &= m \int\! f \,\mathrm{d}v \mathrm{,} \label{Eq:Mom1}
	\\
	\rho(x,t) u(x,t) &= m \int\! v f \,\mathrm{d}v \mathrm{,} \label{Eq:Mom2}
	\\
	E(x,t) &= m \int\! \frac{1}{2}v^2 f  \,\mathrm{d}v \mathrm{,} \label{Eq:Mom:3}
\end{align}
as seen in  \cite{puppo2019kinetic}. Here \(f\) is integrated over velocity space and multiplied by \(m\Phi\) with \(\Phi = [1,v,\frac{1}{2} v^2]\), the collision invariants and \(m\) the mass of the particles.\\ 
Displayed in \cref{Fig:Demo Macro} is a demonstrative example of how the distribution function \(f(v)\) gives the values for the macroscopic quantities. The distribution is centered around the macroscopic velocity \(u\), the mean velocity of the distribution \(f\) is the temperature \(T\), integrating \(f(v)\) over velocity space one obtains the density \(\rho\).\\
Evidently the system in \cref{Eq:BGK} is in equilibrium when \(f = M_f\). Now multiplying the equilibrium solution of \cref{Eq:BGK} by \(m\Phi(v)\) and integrating in velocity space, one finds the Euler system of classical gas dynamics using the equation of state of the gas \cite{puppo2019kinetic}
\begin{align}
	\partial_t&\rho + \partial_x(\rho u) = 0
	\\
	\partial_t&(\rho u) + \partial_x(\rho u^2 + p) = 0
	\\
	\partial_t&E + \partial_x(u(E+p)) = 0 \textrm{.}
\end{align} 
Note that the Boltzmann transport equation the conservative properties of the microscopic collisions lead to a global conservation of mass, momentum and energy. Hence the conservation of mass, momentum and energy is found in the BGk model as well \cite{puppo2019kinetic}.\\
To continue .....
rarefaction KN
SOD
\section{Sod's schock tube as a test case for the BGK model} \label{FeaturesSOD}
\begin{figure}
	\centering
	\input{Figures/BGK/Sod.tex}
	\caption{Problem setup for the Sod shock tube in 1D. A diaphragm is positioned at \(x_d\), seperating the whole domain in two areas. Shown are the starting conditions for \(\rho\),\(v\) and \(T\) indexed with one. Zero indexing refers to the absence of matter.}
	\label{Fig:SodProbSetup}
\end{figure}
\begin{figure}[!htbp]
	\input{Figures/BGK/MacroFOMhyvsrare.tex}
	\caption{Macroscopic quantities \(rho\), \(\rho u\) and \(E\) in the SOD schock tube at the last time stamp. The quantites are displayed for the hydrodynamic regime in - - lines and for the rarefied regime in - lines.}
\end{figure}
- intrinsic code variables for hydro an rare add pls