\begin{tikzpicture}
\begin{scope}[transparency group]
\begin{scope}[blend mode=multiply]

%kernel
\draw [thick, draw=red, fill=black!20!white,scale = .45] (-1,5) rectangle (2,8) grid (-1,5);
%kernel label
\draw [scale=.45,above] node at (0.5,8)  {\footnotesize Kernel};
%kernel components
\draw [scale=.45] node at (-0.5,7.5) {$k_1$};
\draw [scale=.45] node at (-0.5,6.5) {$k_2$};
\draw [scale=.45] node at (-0.5,5.5) {$k_3$};
\draw [scale=.45] node at (0.5,7.5)  {$k_4$};
\draw [scale=.45] node at (0.5,6.5)  {$k_5$};
\draw [scale=.45] node at (0.5,5.5)  {$k_6$};
\draw [scale=.45] node at (1.5,7.5)  {$k_7$};
\draw [scale=.45] node at (1.5,6.5)  {$k_8$};
\draw [scale=.45] node (k9) at (1.5,5.5)  {$k_9$};
%kernel on output
\draw [scale=.45] node [rotate=45] at (6.5,6.5)  {step 1};
\draw [scale=.45] node [rotate=45] at (9.5,6.5)  {step 2};
\draw [scale=.45] node [rotate=45] at (12.5,6.5)  {step 3};

% input label
\draw [thin, draw=black,scale=.45] (-1,-1) grid  (2,2) node at (0.5,-1)[below] {\footnotesize Input};
% step 1 featuremap;
\draw [thin, draw=black,scale = .45] (5,-1) rectangle  (14,8) node at (9.5,-1) [below,text width=4cm,align= center] {\footnotesize Upsampled input};
%draw abc
\draw [scale=.45] node (a) at (-.5,1.5) {a};
\draw [scale=.45] node at (-.5,0.5) {b};
\draw [scale=.45] node at (-.5,-.5) {c};
\draw [scale=.45] node at (0.5,1.5) {d};
\draw [scale=.45] node at (0.5,0.5) {e};
\draw [scale=.45] node at (0.5,-.5) {f};
\draw [scale=.45] node at (1.5,1.5) {g};
\draw [scale=.45] node at (1.5,0.5) {h};
\draw [scale=.45] node at (1.5,-.5) {i};
%draw connections
\draw [thick,scale=.45] (a.north east) -- (2,5) {};
\draw [thick,scale=.45] (a.north west) -- (-1,5){};
\draw [->,thick,scale=.45] (2,5) -- (5,5){};
\draw [->,thick,scale=.45] (2,8) -- (5,8){};
\draw [scale=.45,thick] node at (-.1,3.5) {$\mathbf{\times}$};
\foreach \i in {-1,2,5}
\foreach \j in {5,8,11}
	\draw [thick, draw=red, fill=black!20!white,scale = .45] (\j,\i) grid  (\j+3,\i+3) rectangle (\j,\i);

\end{scope}
\end{scope}
\end{tikzpicture}
