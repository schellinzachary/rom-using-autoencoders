\begin{tikzpicture}
%input layer
\node[circ] at (0, 0)   (1) {};
\node[circ] at (0, .5)  (2) {};
\node[circ] at (0, 1)   (3) {};
\node[circ] at (0, 1.5) (4) {};
\node[circ] at (0, 2)   (5) {};
\node[circ] at (0, 2.5) (6) {};
%code layer
\node[circ] at (2, 0.75) (7) {};
\node[circ] at (2, 1.25) (8) {};
\node[circ] at (2, 1.75) (9) {};
%output layer
\node[circ] at (4, 0)   (10) {};
\node[circ] at (4, .5)  (11) {};
\node[circ] at (4, 1)   (12) {};
\node[circ] at (4, 1.5) (13) {};
\node[circ] at (4, 2)   (14) {};
\node[circ] at (4, 2.5) (15) {};
%draw connections
\foreach \x in {1,...,6,10,11,12,13,14,15}
\foreach \y in {7,8,9}
	\draw (\x) -- (\y);
\draw [thick,decorate,decoration={brace,mirror,amplitude=5pt}] (-.3,-.5) -- (1.98,-.5) node [midway,below = 8pt,draw=none,rectangle split,rectangle split parts=2] 
{Encoder:\nodepart{second} \(h(\Pi)=\Phi\)};
\draw [thick,decorate,decoration={brace,mirror,amplitude=5pt}] (2.02,-.5) -- (4.3,-.5) node [ midway,below= 8pt,draw=none,rectangle split,rectangle split parts=2] {Decoder: \nodepart{second} g(\Phi)=$\tilde{\Pi}$};
\draw [thick,decorate,decoration={brace,amplitude=3pt}] (-.3,2.75) -- (.3,2.75) node [midway,above = 8pt,draw=none,rectangle split,rectangle split parts=2] 
{Input \nodepart{second}Layer};
\draw [thick,decorate,decoration={brace,amplitude=3pt}] (1.7,2) -- (2.3,2) node [midway,above = 8pt,draw=none,rectangle split,rectangle split parts=2] 
{Hidden \nodepart{second}Layer};
\draw [thick,decorate,decoration={brace,amplitude=3pt}] (3.7,2.75) -- (4.3,2.75) node [midway,above = 8pt,draw=none,rectangle split,rectangle split parts=2] 
{Output \nodepart{second}Layer};
\end{tikzpicture}
